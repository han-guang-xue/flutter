### 数据库转移 

转移数据的 库 

```JAVA
url=jdbc:postgresql://192.168.1.23:5432/ycxdb
username=postgres
password=xingshu123
```


1.SQL 导出数据 医生群组   患者群组
```SQL
-- 查询医生群组中所有医生下的患者,然后将这些患者归为一个群组   添加where 条件筛选出某医生关注的所有患者的ID
select ('['||"PHashId"||']')::jsonb  from(
    select array_to_string(array_agg(row_to_json(t1)),',') "PHashId" from(
        select "PHashId" from "DPRelations" where "DHashId" in('f32b6da4599ab613', '471d0e503b422070')  -- and "DPSpecialAttention" = 2
    )t1
)t2;
```

2. 原有数据 转移的表(不需要修改字段)

```JAVA
// 旧表 新表 名称相同
Patients
UserInfo
UserFeedBack
SysUserRole
SystemCongfigures
SymptomStatistics
InfoWxStep
InfoWXPosition
EnquiryLibrary
DPRelations
Doctors
Diseases
Diagnosis
ExaminationReport
```

3.字段需要修改的 表

```java
//旧 -> 新 字段有变化


1.ExaminationReport -> ExaminationReport

/*---------------sql 脚本------------------ */
select
       "ERId" "ERId",
       "ERHashId" "ERHashId",
       "DHashId" "DHashId",
       "PHashId" "PHashId",
       "EIType" "EIType",
       "EIName" "EIName",
       "ERExaminationTime" "ERExaminationTime",
       "ERUploadTime" "ERUploadTime",
       "ERStatus" "ERStatus",
       "POEHashId" "EOHashId",
       "ECreator" "ECreator",
       "ERImages" "ERImages",
       "Read" "Read"
from "ExaminationReport";

/*---------------sql 脚本------------------ */

2.POExaminationItems  -> ExaminationOrders

    
/*---------------sql 脚本------------------ */
    select
        "POEHashId" "EOHashId",
        "ExaminationTime" "EOExamTime",
        "EIName" "EOName",
        "Suggest" "EOSuggest",
        "POECreateTime" "EOCreateTime",
        "POEStatus" "EOStauts",
        "DHashId" "DHashId",
        "PHashId" "PHashId",
        "DGHashId" "DGHashId",
        0 "Creater"
    from "POExaminationItems";
/*---------------sql 脚本------------------ */



MedicalOrders -> MedicalOrders

新增字段 如下, 其它不变

MHashId
MDosage
Duration
TakeAllTimes
TerminationNote

```


4.需要写脚本的

```JAVA
1.对患者表中的主诊断字段 添加数据
2.床位数据筛选出来放入床位表 (BedApplication) 中  //有几个字段未确定,患者申请页面没出来
3.症状问卷表 和 短时频问卷 ,筛选出来放入表 (QuestionnaireAnswer) 中  //暂时有部分数据未完全确定存放格式
```

